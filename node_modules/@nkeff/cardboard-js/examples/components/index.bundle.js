var Cardboard=(()=>{var Ce=Object.defineProperty;var d=(r,e)=>{for(var t in e)Ce(r,t,{get:e[t],enumerable:!0})};var M={};d(M,{clearMountPoints:()=>Ne,context:()=>l,createGlobalObserver:()=>w,generateUID:()=>Pe,getMountPoint:()=>Se,mountPoint:()=>L,resetMountPoints:()=>Te,restoreMountPoint:()=>te,uuidv4:()=>B,withMountPoint:()=>je});var q={};d(q,{CEvent:()=>O,CMappedEvent:()=>T,mappedEvent:()=>Ee,singleEvent:()=>j});var H={};d(H,{arraysEqual:()=>Ie,camelToDash:()=>b,deepEquals:()=>S,isArray:()=>R,isObject:()=>_,removeFromList:()=>N,swapItems:()=>we,val:()=>v});var N=(r,e)=>{if(!e)return!1;let t=e.indexOf(r);return t!==-1?(e.splice(t,1),!0):!1},b=r=>r.replace(/([A-Z])/g,e=>`-${e.toLowerCase()}`),_=r=>typeof r=="object"&&!(r instanceof Array),R=r=>Object.prototype.toString.call(r)==="[object Array]",v=(r,...e)=>typeof r=="function"?r(...e):r,we=(r,e,t)=>{let s=r[e];return r[e]=r[t],r[t]=s,r},Ie=(r,e)=>{if(r===e)return!0;if(r==null||e==null||r.length!==e.length)return!1;for(let t=0;t<r.length;++t)if(r[t]!==e[t])return!1;return!0},S=(r,e)=>{if(r===e)return!0;if(r&&e&&r.length!==e.length)return!1;if(r&&e&&typeof r=="object"&&typeof e=="object"){if(r.constructor!==e.constructor)return!1;var t,s,n;if(Array.isArray(r)){if(t=r.length,t!=e.length)return!1;for(s=t;s--!==0;)if(!S(r[s],e[s]))return!1;return!0}if(r.constructor===RegExp)return r.source===e.source&&r.flags===e.flags;if(r.valueOf!==Object.prototype.valueOf)return r.valueOf()===e.valueOf();if(r.toString!==Object.prototype.toString)return r.toString()===e.toString();if(n=Object.keys(r),t=n.length,t!==Object.keys(e).length)return!1;for(s=t;s--!==0;)if(!Object.prototype.hasOwnProperty.call(e,n[s]))return!1;for(s=t;s--!==0;){var i=n[s];if(!S(r[i],e[i]))return!1}return!0}return r!==r&&e!==e};var O=class{constructor(){this._listeners=[]}listen(e){this._listeners.push(e)}remove(e){N(e,this._listeners)}dispatch(e){this._listeners.forEach(t=>t(e))}destroy(){this._listeners=[]}},T=class{constructor(){this._listeners={}}listen(e,t){e in this._listeners?this._listeners[e]&&this._listeners[e].push(t):this._listeners[e]=[t]}remove(e,t){N(t,this._listeners[e])}dispatch(e,t){e in this._listeners&&this._listeners[e].forEach(s=>s(t))}destroy(){this._listeners={}}},j=()=>new O,Ee=()=>new T;var l={mountPoint:void 0,mountPointHistory:[]},Ae=0;function Pe(){return`_card_${Ae++}`}function B(){return"c_1000000010".replace(/[018]/g,r=>(+r^crypto.getRandomValues(new Uint8Array(1))[0]&15>>+r/4).toString(16))}var Se=()=>l.mountPoint,L=r=>(l.mountPoint&&l.mountPointHistory.push(l.mountPoint),l.mountPoint=r,r),te=()=>{l.mountPoint=l.mountPointHistory.pop()},Ne=()=>{l.mountPoint=void 0,l.mountPointHistory=[]},Te=()=>{let r=l.mountPointHistory.shift();l.mountPoint=r,l.mountPointHistory=[]},je=(r,e)=>{L(r),e(r),te()},w=()=>{let r=j(),e=j();return new window.MutationObserver((s,n)=>{for(let i of s){for(let o of Array.from(i.addedNodes))r.dispatch(o);for(let o of Array.from(i.removedNodes))e.dispatch(o)}}).observe(window.document.body,{childList:!0,subtree:!0}),{onAdded:r,onRemoved:e}};var G={};d(G,{CTag:()=>C,tag:()=>a});var V={};d(V,{text:()=>k});var z={};d(z,{Observable:()=>I,compute:()=>h,computeMultiple:()=>Le,createObservable:()=>p,equalTo:()=>oe,getValue:()=>m,grab:()=>de,greaterThan:()=>re,greaterThanOr:()=>se,isEmpty:()=>ce,isObservable:()=>x,lessThan:()=>ne,lessThanOr:()=>ie,notEmpty:()=>ue,notEqualTo:()=>le});var I=class extends O{get value(){return this._value}set value(e){this.dispatch(e)}constructor(e,t){super(),this.computed=s=>h(this,s),this.greaterThan=(s=0)=>re(this,s),this.greaterThanOr=(s=0)=>se(this,s),this.lessThan=(s=0)=>ne(this,s),this.lessThanOr=(s=0)=>ie(this,s),this.equalTo=s=>oe(this,s),this.notEqualTo=s=>le(this,s),this.isEmpty=()=>ce(this),this.notEmpty=()=>ue(this),this.grab=(s,n)=>de(this,s,n),e&&(_(e)||R(e))&&(e=new Proxy(e,{get(s,n,i){return s[n]},set:(s,n,i,o)=>(s[n]===i||(s[n]=i,super.dispatch(s)),!0),deleteProperty:(s,n)=>(delete s[n],super.dispatch(s),!0)})),this._value=e,this._destroyer=t}valueOf(){return this._value}toString(){return this._value.toString()}changed(e){return this.listen(e),this}remove(e){return super.remove(e),this}dispatch(e){return e===this._value?this:(this._value=e,super.dispatch(e),this)}destroy(){this._destroyer&&this._destroyer(),this._value=null,super.destroy()}},x=r=>r instanceof I,p=(r,e)=>new I(r,e),h=(r,e)=>{let t,s=n=>t?.dispatch(e(n));return t=p(e(r.value),()=>{r.remove(s),t=null,r=null}),r.changed(s),t},Le=(r,e)=>{let t=p(e(...r.map(s=>s.value)));for(let s of r)s.changed(()=>t.dispatch(e(...r.map(n=>n.value))));return t},m=r=>x(r)?r.value:r,re=(r,e=0)=>h(r,t=>t>m(e)),se=(r,e=0)=>h(r,t=>t>=m(e)),ne=(r,e=0)=>h(r,t=>t<m(e)),ie=(r,e=0)=>h(r,t=>t<=m(e)),oe=(r,e)=>h(r,t=>t===m(e)),le=(r,e)=>h(r,t=>t!==m(e)),ce=r=>h(r,e=>e.length<=0),ue=r=>h(r,e=>e.length>0),de=(r,e,t)=>h(r,s=>s&&s[e]?s[e]:t);var k=(r,e)=>{let t=document.createTextNode(""),s=/\B\$([0-9]+|[a-z][a-z0-9_$]*)/gi;if(!e)return t.nodeValue=r,t;let n=i=>{t.nodeValue=i?r.replace(s,(o,c)=>{var f;return((f=i[c])!==null&&f!==void 0?f:o).toString()}):r};if(x(e))e.changed(i=>n(i)),n(e.value);else if(_(e)){for(let i of Object.getOwnPropertyNames(e))r.includes(`$${i}`)&&x(e[i])&&e[i].changed(()=>n(e));n(e)}return t};var F=function(r,e,t,s){function n(i){return i instanceof t?i:new t(function(o){o(i)})}return new(t||(t=Promise))(function(i,o){function c(u){try{y(s.next(u))}catch(g){o(g)}}function f(u){try{y(s.throw(u))}catch(g){o(g)}}function y(u){u.done?i(u.value):n(u.value).then(c,f)}y((s=s.apply(r,e||[])).next())})},C=class r{get visible(){return this._visible}set visible(e){this._visible=e,this.el.dispatchEvent(new CustomEvent("visible",{detail:{visible:e,tag:this},bubbles:!0,composed:!0}))}get parent(){return this._parent}set parent(e){this._parent=e}get children(){return this._getChildren(this.el)}get value(){return this.el.value}setValue(e){return this.el.value=e,this}get checked(){return this.el.checked}setChecked(e){return this.el.checked=e,this}get style(){return this.el.style}get className(){return this.el.className}get classList(){return this.el.classList}get consumeValue(){let e=this.value;return this.clear(),e}get id(){return this.el.id}setId(e){return this.el.id=e,this}constructor(e,t=[],s=!1){if(this._visible=!1,this._destroyers=[],this._children=[],this._cachedChildren=[],this._meta={isHidden:!1,nextSiblingID:null},typeof e=="string"&&e.match(/\(.+\)/)){let i=e.match(/\(([\.\#]?[a-zA-Z][a-zA-Z0-9_$]+)\)/),o=i?i[1]:null;if(!o)throw new Error(`'${e}' is not a valid selector`);let c=document.querySelector(o);if(!c)throw new Error("Can't find element for selector: "+e);this.el=c}else if(typeof e=="string")this.el=document.createElement(e),l.mountPoint&&s&&l.mountPoint.append(this);else if(e instanceof HTMLElement)this.el=e;else throw new Error("Invalid argument: "+e);t.length>0&&this.setChildren(t),this.el.tag=this}setChildren(e){return this.el.replaceChildren(...this._mapChildren(e)),this._children=e,this}append(...e){return this.el.append(...this._mapChildren(e)),this._children.push(...e),this}prepend(...e){return this.el.prepend(...this._mapChildren(e)),this._children.unshift(...e),this}show(){return F(this,void 0,void 0,function*(){if(this.parent&&!this.parent.children.includes(this.el)){let e=this.parent.el,t=this.parent._children.indexOf(this);if(t===0)e.prepend(this.el);else if(t===this.parent._children.length-1)e.append(this.el);else{let s=0;for(let i=t-1;i>=0;i--){let o=this.parent._children[i];o instanceof r&&o._meta.isHidden&&s++}let n=e.childNodes[t-s];e.insertBefore(this.el,n)}}return this._meta.isHidden=!1,!0})}hide(){return F(this,void 0,void 0,function*(){this.parent&&this.parent.children.includes(this.el)&&(this.parent.el.insertBefore(document.createComment(this.el.id),this.el),yield this.remove(),this._meta.isHidden=!0)})}consume(e,t){if(e.changed){let s=n=>t(this,n);e.changed(s),this._destroyers.push(()=>{e.remove(s),e=null})}else console.warn("An invalid Observable was supplied to `tag.consume`");return t(this,"value"in e?e.value:e),this}doIf(e,t,s,n=!1){if(n){let o=t;t=s,s=o}let i=(o,c)=>{c?t(c):s(c)};return this.consume(e,i)}doIfNot(e,t,s){return this.doIf(e,t,s,!0)}hideIf(e,t=!1){let s=(n,i)=>{let o=t?!i:!!i;this._meta.isHidden=o,this.parent&&(o?this.hide():this.show())};return this.consume(e,s)}hideIfNot(e){return this.hideIf(e,!0)}classIf(e,t,s=!1){return this.doIf(e,()=>this.addClass(...v(t,this)),()=>this.rmClass(...v(t,this)),s)}classIfNot(e,t){return this.classIf(e,t,!0)}textIf(e,t,s="",n=!1){return this.doIf(e,()=>this.text(v(t,this)),()=>this.text(v(s,this)),n)}textIfNot(e,t,s=""){return this.textIf(e,t,s,!0)}attrIf(e,t,s="",n=!1){return this.doIf(e,()=>this.addAttr(t,v(s,this)),()=>this.rmAttr(t),n)}attrIfNot(e,t,s=""){return this.attrIf(e,t,s,!0)}disableIf(e,t=!1){return this.attrIf(e,"disabled","",t)}disableIfNot(e){return this.disableIf(e,!0)}styleIf(e,t,s="",n=!1){return this.doIf(e,()=>this.addStyle(t,v(s,this)),()=>this.rmStyle(t),n)}styleIfNot(e,t,s=""){return this.styleIf(e,t,s,!0)}stylesIf(e,t,s=!1){return this.doIf(e,()=>this.setStyle(v(t,this)),()=>this.rmStyle(...Object.keys(t)),s)}stylesIfNot(e,t){return this.stylesIf(e,t,!0)}listen(e,t,s){return e.on(t,(n,i)=>{s(this,n,i)})}text(e,t){return e==null?this.el.textContent:t&&e?this.setChildren([k(e,t)]):(this.el.textContent=e,this)}config(e){if(e.attr&&this.setAttrs(e.attr),e.classList&&this.addClass(...e.classList),e.className&&this.setClassName(e.className),e.style&&this.setStyle(e.style),e.text&&this.text(e.text),e.value&&this.setValue(e.value),e.children&&this.append(...e.children),e.on)for(let t of Object.keys(e.on))this.on(t,e.on[t]);return this}addClass(...e){return this.classList.add(...e),this}setClassName(e){return this.el.className=e,this}rmClass(...e){for(let t of e)this.classList.remove(t);return this}hasClass(...e){for(let t of e)if(!this.classList.contains(t))return!1;return!0}replaceClass(e,t){return this.classList.replace(e,t),this}toggleClass(e){return this.hasClass(e)?this.rmClass(e):this.addClass(e)}addStyle(e,t){return this.el.style[e]=t,this}setStyle(e){var t;for(let s in e)this.addStyle(s,(t=e[s])!==null&&t!==void 0?t:"");return this}rmStyle(...e){for(let t of e)this.style.removeProperty(b(t));return this}hasStyle(...e){for(let t of e)if(!this.style.getPropertyValue(b(t)))return!1;return!0}setAttrs(e){for(let t in e)this.addAttr(t,e[t]);return this}addAttr(e,t=""){return this.el.attributes[e]=t,this.el.setAttribute(e,t),this}rmAttr(...e){for(let t of e)this.el.removeAttribute(t),delete this.el.attributes[t];return this}hasAttr(...e){for(let t of e)if(!(t in this.el.attributes))return!1;return!0}getAttr(e){return this.el.attributes[e]}when(e,t){let s=p({});return this.on(e,(n,i)=>{s.dispatch(t(n,i))}),s}on(e,t){if(t){let s=n=>t(this,n);this.el.addEventListener(e,s),this._destroyers.push(()=>{this.el.removeEventListener(e,s)})}return this}once(e,t){let s=n=>{t(this,n),this.el.removeEventListener(e,s)};return this.el.addEventListener(e,s),this}clicked(e){return this.on("click",e)}keyPressed(e,t){return t?this.on("keypress",(s,n)=>{(n.code===t||n.key===t)&&e(this,n)}):this.on("keypress",e)}changed(e){return this.on("change",e)}submited(e){return this.on("submit",e)}remove(){return F(this,void 0,void 0,function*(){let e=this.el.remove();return e instanceof Promise&&(yield e),yield this.el.remove(),this})}destroy(){var e;(e=l.intersectionObserver)===null||e===void 0||e.unobserve(this.el),this._children.forEach(t=>{t instanceof r&&t.destroy()}),this._destroyers.forEach(t=>t()),this._children=[],this._cachedChildren=[],this.remove()}clear(){return this.el.value="",this.el.dispatchEvent(new InputEvent("input")),this}disable(){return this.setDisabled(!0)}enable(){return this.setDisabled(!1)}setDisabled(e){return e?this.addAttr("disabled"):this.rmAttr("disabled")}q(e){let t=this.el.querySelector(e);if(t)return new r(t)}find(e){for(let t of this._children)if(e(t))return t}findTag(e){for(let t of this._children)if(t instanceof r&&e(t))return t}_childrenFilterPredicate(e){return!(e instanceof r&&e._meta.isHidden)}_getElementForChild(e){return typeof e=="string"?document.createTextNode(e):x(e)?k("$val",{val:e}):e instanceof r?e.el:e instanceof Node?e:null}_getChildren(e){return this._observer||(this._observer=new window.MutationObserver(()=>{this._cacheChildren(e)}),this._observer.observe(this.el,{childList:!0}),this._cacheChildren(e)),this._cachedChildren}_cacheChildren(e){let t=e.childNodes,s=[],n=t.length;for(;n--;)t[n].nodeType===1&&s.unshift(t[n]);this._cachedChildren=s}_mapChildren(e){let t=[];for(let s of e)if(s instanceof r&&(s.parent=this),this._childrenFilterPredicate(s)){let n=this._getElementForChild(s);n!=null&&t.push(n)}return t}},a=(r,e=[],t=!1)=>new C(r,e,t);var Z={};d(Z,{listState:()=>ke,state:()=>he,stateAdd:()=>ae,stateAddAt:()=>fe,stateRemove:()=>pe,stateRemoveWhere:()=>X});var he=r=>p(r),ke=r=>{let e=he(r.map(n=>p(n)));return{get list(){return e},get listValue(){return e.value},add:n=>{ae(e,p(n))},addAt:(n,i)=>{fe(e,p(n),i)},remove:pe.bind({},e),removeWhere:X.bind({},e),length:e.computed(n=>n.length)}},ae=(r,e)=>{r.value=[...r.value,e]},fe=(r,e,t)=>{let s=[...r.value];s.splice(t,0,e),r.value=s,s=[]},X=(r,e)=>{r.value=r.value.filter((t,s)=>!e(t,s))},pe=(r,e)=>{let t=r.value.findIndex(s=>m(s)===m(e));X(r,(s,n)=>t===n)};var U={};d(U,{genBlock:()=>me,genBlockContent:()=>W,genCss:()=>E});var E=r=>{let e=r instanceof Array?r:[r],t="";for(let s of e)for(let n in s)t+=me(n,s[n]);return t},me=(r,e)=>W(r,e).join(""),W=(r,e)=>{let t="",s=[];for(let n in e)if(_(e[n])){let i=r;i+=n,s.push(...W(i,e[n]))}else e[n]&&(t+=`${b(n)}:${e[n]};`);return s.unshift(`${r}{${t}}`),s};var J={};d(J,{onLifecycle:()=>ve,withLifecycle:()=>$e});var Y=function(r,e,t,s){function n(i){return i instanceof t?i:new t(function(o){o(i)})}return new(t||(t=Promise))(function(i,o){function c(u){try{y(s.next(u))}catch(g){o(g)}}function f(u){try{y(s.throw(u))}catch(g){o(g)}}function y(u){u.done?i(u.value):n(u.value).then(c,f)}y((s=s.apply(r,e||[])).next())})};function ve(r,e,t,s){if(s){let o=r.el.remove;r.el.remove=()=>Y(this,void 0,void 0,function*(){let c=s(r);return(!c||c instanceof Promise&&(yield c))&&o.call(r.el),c.valueOf()})}if(e){let o=r.show;r.show=()=>Y(this,void 0,void 0,function*(){let c=o.call(r);return c instanceof Promise?yield c:c})}l.observer||(l.observer=w());let n,i;l.observer.onAdded.listen(n=o=>Y(this,void 0,void 0,function*(){if((o===r.el||o.contains(r.el))&&e){let f=e(r);f instanceof Promise&&(yield f)}})),l.observer.onRemoved.listen(i=o=>{(o===r.el||o.contains(r.el))&&t&&t(r)}),r._destroyers.push(()=>{var o,c;(o=l.observer)===null||o===void 0||o.onRemoved.remove(i),(c=l.observer)===null||c===void 0||c.onAdded.remove(n),t=void 0,e=void 0})}var $e=(r,e)=>(ve(r,e.mounted,e.unmounted,e.beforeUnmounted),r);var K={};d(K,{allTags:()=>A});var $={ul:(r,e=!1)=>a("ul",r.map(t=>a("li",[t],e))),style:(r,e=!1)=>a("style",[E(r)],e)},A=new Proxy({},{get:(r,e,t)=>{let s=e.toString(),n=(...i)=>$[s]?$[s](i,!1):a(s,i);return Object.defineProperty(n,"mount",{get:()=>(...i)=>$[s]?$[s](i,!0):a(s,i,!0)}),n}});var Q={};d(Q,{StyleManager:()=>P});var xe="cardboard-styles",P=class{constructor(){this.generatedIdsCount=0,this.rules=new Set;let e=null;try{e=a(`(#${xe})`)}catch{e=a("style").setId(xe)}a("(head)").append(e),this.styleTag=e}add(e){let t=E(e);this.rules.has(t)||(this.rules.add(t),this.styleTag.append(t))}};var ye;(function(r){r.unchanged="unchanged",r.added="added",r.removed="removed",r.swap="swap"})(ye||(ye={}));var ge=(r={selector:"body"})=>{let e=new C(`(${r.selector})`);return l.observer=w(),l.styleManager=new P,L(e)},ut=Object.assign(Object.assign(Object.assign(Object.assign(Object.assign(Object.assign(Object.assign(Object.assign(Object.assign(Object.assign(Object.assign(Object.assign({},G),Z),U),H),V),q),z),J),M),K),Q),{version:"0.0.4"});var{input:Ct}=A;function D(r){let e=!1,t=B(),s,n=function(...i){var o;return s?(e||(e=!0,s&&((o=l.styleManager)===null||o===void 0||o.add({[`.${t}`]:s}))),r(...i).addClass(t)):r(...i)};return n.styled=(i,o)=>(s=i||{},t=o||t,n),n}var ee={styledThing:{backgroundColor:"#466187",borderRadius:"16px",textAlign:"center",margin:"10px",color:"white"," span":{margin:"16px 0",fontSize:"20px"}," p":{fontSize:"16px"},":hover":{color:"lightblue"}},row:{display:"flex",alignItems:"center",padding:"0 32px",".space-between":{justifyContent:"space-between"},".space-around":{justifyContent:"space-around"},".center":{justifyContent:"center"},".flex-start":{justifyContent:"flex-start"},".flex-end":{justifyContent:"flex-end"}}};var{div:be,p:Re,span:_e}=A,He=D((r,e)=>be(...r).addClass(e)).styled(ee.row),Oe=D(()=>be(He([_e("X"),Re("This is a styled component"),_e("X")],"space-between"))).styled(ee.styledThing);var qe=ge();l.styleManager.add({body:{fontFamily:"Arial, sans-serif",fontSize:"16px"}});var Be=performance.now(),Me=Array.from({length:100},(r,e)=>Oe());qe.append(...Me);var ze=performance.now();console.log("Components rendered in",ze-Be,"ms");})();
