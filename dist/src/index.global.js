(function(){'use strict';var _=(s,e,t)=>new Promise((r,i)=>{var n=o=>{try{u(t.next(o));}catch(b){i(b);}},l=o=>{try{u(t.throw(o));}catch(b){i(b);}},u=o=>o.done?r(o.value):Promise.resolve(o.value).then(n,l);u((t=t.apply(s,e)).next());}),H=(s,e)=>{if(!e)return  false;let t=e.indexOf(s);return t!==-1?(e.splice(t,1),true):false},C=s=>s.replace(/([A-Z])/g,e=>`-${e.toLowerCase()}`),x=s=>typeof s=="object"&&!(s instanceof Array),V=s=>Object.prototype.toString.call(s)==="[object Array]",f=(s,...e)=>typeof s=="function"?s(...e):s;function q(){return "c_1000000010".replace(/[018]/g,s=>(+s^crypto.getRandomValues(new Uint8Array(1))[0]&15>>+s/4).toString(16))}var E=class{constructor(){this._lstrs=[];}listen(s){this._lstrs.push(s);}remove(s){H(s,this._lstrs);}dispatch(s){this._lstrs.forEach(e=>e(s));}destroy(){this._lstrs=[];}};var I=()=>new E;var a={mp:void 0,mpHistory:[],styleManager:void 0,intObs:void 0,obs:void 0,init:false},B=()=>a.init===true,D=()=>{if(!B())throw new Error("Cardboard is not initialized. Please call `init()`, as some features will not work.")},A=()=>a.mp,z=s=>(a.mp&&a.mpHistory.push(a.mp),a.mp=s,s);var R=()=>{let s=I(),e=I();return new window.MutationObserver((t,r)=>{for(let i of t){for(let n of Array.from(i.addedNodes))s.dispatch(n);for(let n of Array.from(i.removedNodes))e.dispatch(n);}}).observe(window.document.body,{childList:true,subtree:true}),{onAdded:s,onRemoved:e}},S=class extends E{constructor(s,e){super(),this.computed=t=>d(this,t),this.greaterThan=(t=0)=>F(this,t),this.greaterThanOr=(t=0)=>U(this,t),this.lessThan=(t=0)=>Z(this,t),this.lessThanOr=(t=0)=>W(this,t),this.equalTo=t=>G(this,t),this.notEqualTo=t=>K(this,t),this.isEmpty=()=>Y(this),this.notEmpty=()=>J(this),this.grab=(t,r)=>Q(this,t,r),s&&(x(s)||V(s))&&(s=new Proxy(s,{get(t,r,i){return t[r]},set:(t,r,i,n)=>(t[r]===i||(t[r]=i,super.dispatch(t)),true),deleteProperty:(t,r)=>(delete t[r],super.dispatch(t),true)})),this._value=s,this._destroyer=e;}get value(){return this._value}set value(s){this.dispatch(s);}valueOf(){return this._value}toString(){return this._value.toString()}changed(s){return this.listen(s),this}remove(s){return super.remove(s),this}dispatch(s){return s===this._value?this:(this._value=s,super.dispatch(s),this)}destroy(){this._destroyer&&this._destroyer(),this._value=null,super.destroy();}},v=s=>s instanceof S,w=(s,e)=>new S(s,e),d=(s,e)=>{let t,r=i=>t==null?void 0:t.dispatch(e(i));return t=w(e(s.value),()=>{s.remove(r),t=null,s=null;}),s.changed(r),t};var p=s=>v(s)?s.value:s,F=(s,e=0)=>d(s,t=>t>p(e)),U=(s,e=0)=>d(s,t=>t>=p(e)),Z=(s,e=0)=>d(s,t=>t<p(e)),W=(s,e=0)=>d(s,t=>t<=p(e)),G=(s,e)=>d(s,t=>t===p(e)),K=(s,e)=>d(s,t=>t!==p(e)),Y=s=>d(s,e=>e.length<=0),J=s=>d(s,e=>e.length>0),Q=(s,e,t)=>d(s,r=>r&&r[e]?r[e]:t),y=(s,e)=>{let t=document.createTextNode(""),r=/\B\$([0-9]+|[a-z][a-z0-9_$]*)/gi;if(!e)return t.nodeValue=s,t;let i=n=>{t.nodeValue=n?s.replace(r,(l,u)=>{var o;return ((o=n[u])!=null?o:l).toString()}):s;};if(v(e))e.changed(n=>i(n)),i(e.value);else if(x(e)){for(let n of Object.getOwnPropertyNames(e))s.includes(`$${n}`)&&v(e[n])&&e[n].changed(()=>i(e));i(e);}return t},N=class c{constructor(e,t=[],r=false){if(this._visible=false,this._destroyers=[],this._children=[],this._cachedChildren=[],this._meta={isHidden:false,nextSiblingID:null},typeof e=="string"&&e.match(/\(.+\)/)){let i=e.match(/\(([\.\#]?[a-zA-Z][a-zA-Z0-9_$]+)\)/),n=i?i[1]:null;if(!n)throw new Error(`'${e}' is not a valid selector`);let l=document.querySelector(n);if(!l)throw new Error("Can't find element for selector: "+e);this.el=l;}else if(typeof e=="string")this.el=document.createElement(e),a.mp&&r&&a.mp.append(this);else if(e instanceof HTMLElement)this.el=e;else throw new Error("Invalid argument: "+e);t.length>0&&this.setChildren(t),this.el.tag=this;}get visible(){return this._visible}set visible(e){this._visible=e,this.el.dispatchEvent(new CustomEvent("visible",{detail:{visible:e,tag:this},bubbles:true,composed:true}));}get parent(){return this._parent}set parent(e){this._parent=e;}get children(){return this._getChildren(this.el)}get value(){return this.el.value}setValue(e){return this.el.value=e,this}get checked(){return this.el.checked}setChecked(e){return this.el.checked=e,this}get style(){return this.el.style}get className(){return this.el.className}get classList(){return this.el.classList}get consumeValue(){let e=this.value;return this.clear(),e}get id(){return this.el.id}setId(e){return this.el.id=e,this}setChildren(e){return this.el.replaceChildren(...this._mapChildren(e)),this._children=e,this}append(...e){return this.el.append(...this._mapChildren(e)),this._children.push(...e),this}prepend(...e){return this.el.prepend(...this._mapChildren(e)),this._children.unshift(...e),this}show(){return _(this,null,function*(){if(this.parent&&!this.parent.children.includes(this.el)){let e=this.parent.el,t=this.parent._children.indexOf(this);if(t===0)e.prepend(this.el);else if(t===this.parent._children.length-1)e.append(this.el);else {let r=0;for(let n=t-1;n>=0;n--){let l=this.parent._children[n];l instanceof c&&l._meta.isHidden&&r++;}let i=e.childNodes[t-r];e.insertBefore(this.el,i);}}return this._meta.isHidden=false,true})}hide(){return _(this,null,function*(){var e;(e=this.parent)!=null&&e.children.includes(this.el)&&(this.parent.el.insertBefore(document.createComment(this.el.id),this.el),yield this.remove(),this._meta.isHidden=true);})}consume(e,t){if(e.changed){let r=i=>t(this,i);e.changed(r),this._destroyers.push(()=>{e.remove(r),e=null;});}else console.warn("An invalid Observable was supplied to `tag.consume`");return t(this,"value"in e?e.value:e),this}doIf(e,t,r,i=false){if(i){let l=t;t=r,r=l;}let n=(l,u)=>{u?t(u):r(u);};return this.consume(e,n)}doIfNot(e,t,r){return this.doIf(e,t,r,true)}hideIf(e,t=false){let r=(i,n)=>{let l=t?!n:!!n;this._meta.isHidden=l,this.parent&&(l?this.hide():this.show());};return this.consume(e,r)}hideIfNot(e){return this.hideIf(e,true)}classIf(e,t,r=false){return this.doIf(e,()=>this.addClass(...f(t,this)),()=>this.rmClass(...f(t,this)),r)}classIfNot(e,t){return this.classIf(e,t,true)}textIf(e,t,r="",i=false){return this.doIf(e,()=>this.text(f(t,this)),()=>this.text(f(r,this)),i)}textIfNot(e,t,r=""){return this.textIf(e,t,r,true)}attrIf(e,t,r="",i=false){return this.doIf(e,()=>this.addAttr(t,f(r,this)),()=>this.rmAttr(t),i)}attrIfNot(e,t,r=""){return this.attrIf(e,t,r,true)}disableIf(e,t=false){return this.attrIf(e,"disabled","",t)}disableIfNot(e){return this.disableIf(e,true)}styleIf(e,t,r="",i=false){return this.doIf(e,()=>this.addStyle(t,f(r,this)),()=>this.rmStyle(t),i)}styleIfNot(e,t,r=""){return this.styleIf(e,t,r,true)}stylesIf(e,t,r=false){return this.doIf(e,()=>this.setStyle(f(t,this)),()=>this.rmStyle(...Object.keys(t)),r)}stylesIfNot(e,t){return this.stylesIf(e,t,true)}styled(e,t){var r;return t!=null||(t=q()),e&&((r=a.styleManager)==null||r.add({[`.${t}`]:e})),this.addClass(t)}text(e,t){return e==null?this.el.textContent:t&&e?this.setChildren([y(e,t)]):(this.el.textContent=e,this)}config(e){if(e.attr&&this.setAttrs(e.attr),e.classList&&this.addClass(...e.classList),e.className&&this.setClassName(e.className),e.style&&this.setStyle(e.style),e.text&&this.text(e.text),e.value&&this.setValue(e.value),e.children&&this.append(...e.children),e.on)for(let t of Object.keys(e.on))this.on(t,e.on[t]);return this}addClass(...e){return this.classList.add(...e),this}setClassName(e){return this.el.className=e,this}rmClass(...e){for(let t of e)this.classList.remove(t);return this}hasClass(...e){for(let t of e)if(!this.classList.contains(t))return  false;return  true}replaceClass(e,t){return this.classList.replace(e,t),this}toggleClass(e){return this.hasClass(e)?this.rmClass(e):this.addClass(e)}addStyle(e,t){return this.el.style[e]=t,this}setStyle(e){var t;for(let r in e)this.addStyle(r,(t=e[r])!=null?t:"");return this}rmStyle(...e){for(let t of e)this.style.removeProperty(C(t));return this}hasStyle(...e){for(let t of e)if(!this.style.getPropertyValue(C(t)))return  false;return  true}setAttrs(e){for(let t in e)this.addAttr(t,e[t]);return this}addAttr(e,t=""){return this.el.attributes[e]=t,this.el.setAttribute(e,t),this}rmAttr(...e){for(let t of e)this.el.removeAttribute(t),delete this.el.attributes[t];return this}hasAttr(...e){for(let t of e)if(!(t in this.el.attributes))return  false;return  true}getAttr(e){return this.el.attributes[e]}listen(e,t,r){return e.on(t,(i,n)=>{r(this,i,n);})}when(e,t){let r=w({});return this.on(e,(i,n)=>{r.dispatch(t(i,n));}),r}on(e,t){if(t){let r=i=>t(this,i);this.el.addEventListener(e,r),this._destroyers.push(()=>{this.el.removeEventListener(e,r);});}return this}once(e,t){let r=i=>{t(this,i),this.el.removeEventListener(e,r);};return this.el.addEventListener(e,r),this}clicked(e){return this.on("click",e)}keyPressed(e,t){return t?this.on("keypress",(r,i)=>{(i.code===t||i.key===t)&&e(this,i);}):this.on("keypress",e)}changed(e){return this.on("change",e)}submited(e){return this.on("submit",e)}remove(){return _(this,null,function*(){let e=this.el.remove();return e instanceof Promise&&(yield e),yield this.el.remove(),this})}destroy(){var e;(e=a.intObs)==null||e.unobserve(this.el),this._children.forEach(t=>{t instanceof c&&t.destroy();}),this._destroyers.forEach(t=>t()),this._children=[],this._cachedChildren=[],this.remove();}clear(){return this.el.value="",this.el.dispatchEvent(new InputEvent("input")),this}disable(){return this.setDisabled(true)}enable(){return this.setDisabled(false)}setDisabled(e){return e?this.addAttr("disabled"):this.rmAttr("disabled")}q(e){let t=this.el.querySelector(e);if(t)return new c(t)}find(e){for(let t of this._children)if(e(t))return t}findTag(e){for(let t of this._children)if(t instanceof c&&e(t))return t}_childrenFilterPredicate(e){return !(e instanceof c&&e._meta.isHidden)}_getElementForChild(e){return typeof e=="string"?document.createTextNode(e):v(e)?y("$val",{val:e}):e instanceof c?e.el:e instanceof Node?e:null}_getChildren(e){return this._observer||(this._observer=new window.MutationObserver(()=>{this._cacheChildren(e);}),this._observer.observe(this.el,{childList:true}),this._cacheChildren(e)),this._cachedChildren}_cacheChildren(e){let t=e.childNodes,r=[],i=t.length;for(;i--;)t[i].nodeType===1&&r.unshift(t[i]);this._cachedChildren=r;}_mapChildren(e){let t=[];for(let r=0;r<e.length;r++){let i=e[r];if(i instanceof c&&(i.parent=this),this._childrenFilterPredicate(i)){let n=this._getElementForChild(i);n!=null&&t.push(n);}}return t}},h=(s,e=[],t=false)=>(D(),new N(s,e,t)),T=s=>{let e=s instanceof Array?s:[s],t="";for(let r of e)for(let i in r)t+=X(i,r[i]);return t},X=(s,e)=>P(s,e).join(""),P=(s,e)=>{let t="",r=[];for(let i in e)if(x(e[i])){let n=s;n+=i,r.push(...P(n,e[i]));}else e[i]&&(t+=`${C(i)}:${e[i]};`);return r.unshift(`${s}{${t}}`),r},O="cardboard-styles",ee=class{constructor(){this.generatedIdsCount=0,this.rules=new Set;let s=null;try{s=h(`(#${O})`);}catch(e){s=h("style").setId(O);}h("(head)").append(s),this.styleTag=s;}add(s){let e=T(s);this.rules.has(e)||(this.rules.add(e),this.styleTag.append(e));}},k=s=>w(s);var te=(s=>(s.unchanged="unchanged",s.added="added",s.removed="removed",s.swap="swap",s))(te||{});var m={ul:(s,e=false)=>h("ul",s.map(t=>h("li",[t],e))),style:(s,e=false)=>h("style",[T(s)],e)},g=new Proxy({},{get:(s,e,t)=>{let r=e.toString(),i=(...n)=>m[r]?m[r](n,false):h(r,n);return Object.defineProperty(i,"mount",{get:()=>(...n)=>m[r]?m[r](n,true):h(r,n,true)}),i}}),L=(s={selector:"body"})=>{a.init=true,a.obs=R(),a.styleManager=new ee;let e=new N(`(${s.selector})`);return z(e)};var{button:se,p:$,div:re}=g,j=s=>se().text("Clicked $count times",{count:s}).styled({color:"#333",fontSize:"2rem",padding:"1rem 2rem",borderRadius:"0.5rem",border:"none",outline:"none",backgroundColor:"#f0f0f0",cursor:"pointer",transform:"scale(1)",transition:"all 0.1s ease-in-out",":hover":{backgroundColor:"#d9d9d9",transform:"scale(1.01)"},":active":{backgroundColor:"#d3d3d3",transform:"scale(0.97)"}},"counter").addClass("clicker").clicked(e=>{s.value++;}),M=s=>re($(y("Click $count more times",{count:s})).hideIf(s.greaterThanOr(5)),$("Count is above 5!!").styled({color:"limegreen"}).hideIfNot(s.greaterThanOr(5)));var{style:ie,p:ge}=g;function ne(){L({selector:"body"}),h("(html)").append(ie({body:{display:"flex",flexDirection:"column",alignItems:"center",justifyContent:"center",height:"100vh",margin:"0"}}));}function le(){var e;let s=k(0);(e=A())==null||e.append(j(s),M(s));}document.addEventListener("DOMContentLoaded",()=>{ne(),le();});})();//# sourceMappingURL=index.global.js.map
//# sourceMappingURL=index.global.js.map